## 负载均衡

1. Ribbon与Nginx
   1. Ribbon是SpringCloud客户端负载均衡器（在客户端本地实现负载均衡）
      *  当**服务1**需要调用**服务2**的时候
      * 先以**服务2**的别名到注册中心上获取对应的**服务2**实际接口地址（一般服务都会搭建多个，所有获取到的接口地址会是一个**List**）
      * 当**服务1**获取到地址之后，缓存到本地，然后在本地实现远程RPC调用。（这里涉及到一个小细节，当服务2的某个服务被注册中心剔除后，在一定时间内服务1依旧会去调用这个被剔除的服务，原因就是这个缓存）
      * 这时候**服务1**就通过缓存到本地的地址对**服务2**进行调用，这时候**服务1**就需要对多个**服务2**的地址进行挑选，这个在本地挑选的过程就叫**负载均衡**。
      * 服务1调用服务2的策略就叫负载均衡算法，原理是：接口i的总请求数%服务器数量（取模 ），得到实际下标服务器位置（因为获取到的接口地址在本地是一个List，这个下标就是List的index，调用的服务就是index对应的值）。
   2.  Nginx是服务器负载均衡，客户端所有请求都会交给Nginx，然后再由nginx实现转发请求，即负载均衡是由服务器端实现的。
   3. 应用场景：
      1. 本地负载均衡器适合在微服务RPC远程调用，比如Dubbo、SpringCloud
      2. Nginx服务器负载均衡适合于针对服务器端比如Tomcat、jetty

