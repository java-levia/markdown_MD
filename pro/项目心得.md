项目心得

1. 优惠券数据库的创建
   1. 如果优惠券的种类比较多的情况下创建数据库要考虑到一个批次问题
   2. 创建优惠券表时，能用一张表尽量不要使用两名表
   3. 对一行数据做更改时，切记校验乐观锁

2. 提现逻辑

   1. 涉及到的表
      1. 用户表c_customer
      2. 用户账户表 c_account
      3. 银行卡详情表 bank_details
      4. 提现规则表  sys_cash_rule
      5. 金额操作明细表  c_money_details
      6. 提现申请记录表  sys_cash_details
   2. 业务流程
      * 用户校验（用户表c_customer）
      * 用户账户校验(用户账户表 c_account)
      * 确保用户id和bankDetails表中的customer_id匹配 
      * 获取提现规则
        * 提现是否开启
        * 提现金额大于最小提现金额  小于最大提现金额
        * 提现金额为某个数的整数倍
        * 限制每日/周/月的提现次数
        * 校验提现短信（提现密码）
      * 生成提现流水号
      * 执行转账逻辑（包括余额校验和转账细节的记录）
        * 查询用户账户金额
        * 操作用户账户金额
        * 修改用户余额
        * 插入用户金额明细表
   3. sys_cash_details数据插入

   

3. 接口的整合
   1. 如果同一个模块下，多个接口的参数相同，可以考虑将多个接口整合起来，对后端来说可以减少很多重复的代码，对前端来说也可以少调用很多接口，缩短开发时间。
   2. 善用乐观锁，更新或者插入数据时，如果影响的行数为1行，抛出自定义异常进行回滚。
   3. 事务控制，如果两个方法嵌套，则两个方法都需要做好事务控制
   4. 尽量减少连接数据库的次数，特别是不要在循环中连接数据库
   5. 查询列表时，如果对这个列表有后续操作，在操作之前先做非空判断，如果为空，直接返回成功，给一个空列表
   6. 对多个id进行查找时，除了前端传入可变参数之外，还可以通过传入一个逗号分隔的id拼接成的字符串，将这个字符串传入到数据库中之后，可以通过find_in_set()函数进行处理